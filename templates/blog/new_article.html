{% extends "../layouts/master.html" %}

{% block content %}
<div id="app">
    <el-form ref="form" :model="form" label-width="80px">
        <el-form-item label="文章标题">
            <el-input v-model="form.title"></el-input>
        </el-form-item>
        <el-form-item label="发布时间">
            <el-date-picker
                v-model="form.pub_date"
                type="datetime"
                placeholder="选择日期时间"
                align="right"
                :picker-options="pickerOptions">
            </el-date-picker>
        </el-form-item>
        <el-form-item label="置顶">
            <el-switch on-text="" off-text="" v-model="form.set_top"></el-switch>
        </el-form-item>
        <el-form-item label="活动形式">
            <el-input
                type="textarea"
                :rows="20"
                placeholder="请输入内容"
                v-model="form.content">
            </el-input>
        </el-form-item>
        <el-form-item>
            <el-button type="primary" @click="onSubmit">立即创建</el-button>
            <el-button>取消</el-button>
        </el-form-item>
    </el-form>
</div>
{% endblock %}

{% block js %}
<script>
    var vm = new Vue({
        el: '#app',
        data() {
            return {
                pickerOptions: {
                shortcuts: [
                    {
                        text: '今天',
                        onClick(picker) {
                            picker.$emit('pick', new Date());
                        }
                    },
                    {
                        text: '昨天',
                        onClick(picker) {
                            const date = new Date();
                            date.setTime(date.getTime() - 3600 * 1000 * 24);
                            picker.$emit('pick', date);
                        }
                    },
                    {
                        text: '一周前',
                        onClick(picker) {
                            const date = new Date();
                            date.setTime(date.getTime() - 3600 * 1000 * 24 * 7);
                            picker.$emit('pick', date);
                        }
                    }
                ]
            },
                form: {
                    title: '',
                    pub_date: '',
                    set_top: false,
                    content: ''
                }
            }
        },
        methods: {
            onSubmit() {
                axios.post("{% url 'new_article' %}", vm.form)
                    .then(function (response) {
                        console.log(response);})
                    .catch(function (error) {
                        console.log(error);
                    });
            }
        }
    })
//  var Ctor = Vue.extend(Main)
//  new Ctor().$mount('#app')
</script>
{% endblock %}